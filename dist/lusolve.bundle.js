function m(s,e){const n=s.length;if(Array.isArray(e[0])){if(!Array.isArray(e)||e.length!==n||e.some(t=>!Array.isArray(t)||t.length!==1))throw new Error("Dimension mismatch. Matrix columns must match vector length.")}else if(e.length!==n)throw new Error("Dimension mismatch. Matrix columns must match vector length.");const{L:l,U:a,p:f}=h(s),r=y(e,f),o=u(l,r);return g(a,o)}function h(s){const e=s.length,n=s.map(r=>r.slice()),l=Array.from({length:e},(r,o)=>o);for(let r=0;r<e;r++){let o=Math.abs(n[r][r]),i=r;for(let t=r+1;t<e;t++)Math.abs(n[t][r])>o&&(o=Math.abs(n[t][r]),i=t);if(o<1e-12)throw new Error("Cannot solve linear system, matrix is singular");i!==r&&([n[r],n[i]]=[n[i],n[r]],[l[r],l[i]]=[l[i],l[r]]);for(let t=r+1;t<e;t++){n[t][r]/=n[r][r];for(let c=r+1;c<e;c++)n[t][c]-=n[t][r]*n[r][c]}}const a=Array.from({length:e},(r,o)=>Array.from({length:e},(i,t)=>o>t?n[o][t]:o===t?1:0)),f=Array.from({length:e},(r,o)=>Array.from({length:e},(i,t)=>o<=t?n[o][t]:0));return{L:a,U:f,p:l}}function y(s,e){return Array.isArray(s[0])?e.map(n=>s[n].slice()):e.map(n=>s[n])}function u(s,e){const n=s.length,l=Array.isArray(e[0])?e[0].length:1,a=l>1?Array.from({length:n},()=>Array(l).fill(0)):Array(n).fill(0);for(let f=0;f<l;f++)for(let r=0;r<n;r++){let o=0;for(let t=0;t<r;t++)o+=s[r][t]*(l>1?a[t][f]:a[t]);const i=l>1?e[r][f]:e[r];l>1?a[r][f]=i-o:a[r]=i-o}return a}function g(s,e){const n=s.length,l=Array.isArray(e[0])?e[0].length:1,a=l>1?Array.from({length:n},()=>Array(l).fill(0)):Array(n).fill(0);for(let f=0;f<l;f++)for(let r=n-1;r>=0;r--){let o=0;for(let t=r+1;t<n;t++)o+=s[r][t]*(l>1?a[t]:a)[t];const i=l>1?e[r][f]:e[r];if(Math.abs(s[r][r])<1e-12)throw new Error("Cannot solve linear system, matrix is singular");l>1?a[r][f]=(i-o)/s[r][r]:a[r]=(i-o)/s[r][r]}return a}console.log(typeof m);
